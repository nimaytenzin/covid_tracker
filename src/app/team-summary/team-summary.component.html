<ng-multiselect-dropdown
[placeholder]="'Select Operators and Click on fetch Data'"
[data]="dropdownList"
[(ngModel)]="selectedItems"
[settings]="dropdownSettings"
(onSelect)="onItemSelect($event)"
>

</ng-multiselect-dropdown>

<br>
<div style="display: flex;align-items: center;justify-content: left;">
    <button mat-raised-button (click) = "getSummary()"> <mat-icon>rotate_left</mat-icon> Fetch Data</button>
    <br>
    <button mat-raised-button (click)="exportToExcel()"> <mat-icon>download</mat-icon> Download as xlsx</button>
</div>

<br>

<table #testTable id="test-table"style = "width:100%;">
  <tr>
    <th>Sl-No</th>
    <th>Operator ID</th>
    <th>Sample ID</th>
    <th>Name</th>
    <th>Gender</th>
    <th>CID</th>
    <th>Age</th>
    <th>Contact</th>
    <th>Work Agency</th>
    <th>RT_PCR</th>
    <th>Antigen</th>
    <th>Antibody</th>
    <th>Place of Sample Collection</th>
    <th>Test Date</th>

  </tr>
  <tr *ngFor = "let test of tests; let i = index">
      <td>{{i+1}}</td>
      <td>{{test.operator_id}}</td>
      <td>{{test.sample_id}}</td>
      <td>{{test.Subject.name}}</td>
      <td>{{test.Subject.sex}}</td>
      <td>{{test.Subject.cid}}</td>
      <td>{{test.Subject.age}}</td>
      <td>{{test.Subject.contact}}</td>
      <td>{{test.Subject.work_category}}</td>
      <td>{{test.test_RTPCR}}</td>
      <td>{{test.test_AG}}</td>
      <td>{{test.test_AB}}</td>
      <td>{{test.place}}</td>
      <td>{{test.test_date | date: 'mediumDate'}}</td>
      
  </tr>
</table>

